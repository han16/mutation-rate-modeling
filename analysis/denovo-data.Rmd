---
title: "De novo mutations of ASD"
author: "Shengtong  Han"
date: YYYY-MM-DD
output: html_document
---

<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
```{r read-chunk, include=FALSE, cache=FALSE}
knitr::read_chunk("chunks.R")
library(knitr)
```

<!-- Update knitr chunk options -->
```{r knitr-opts-chunk, include=FALSE}
```

<!-- Insert the date the file was last updated -->
```{r last-updated, echo=FALSE, results='asis'}
```

<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
```{r code-version, echo=FALSE, results='asis'}
```

## Samples and reference windows


### Reference window

Example_windows_with_div_score.bed: each row is a 50bp window with a few features, such as mutation rate, coding, promoter, GC content, and divergence score; only cover genes and 10-kb regions within TSSs. 


### Case Samples 



index    | Samples | \# mutations| \# subjects
----|-------|-------|---
1 | Jiang_cases_DNM.bed | 2,091| 32
2 | Michaelson_cases_DNM.bed |581 | 10
3 | Yuen_NM2015_cases_DNM.bed | 9,381| 162
4 | Wu_cases_DNM.bed | 1,915 | 32
5 | Kong_cases_DNM.bed | 4,930 | 78

Table: Five WGS  DNM case sample information



### Control sample 

index    | Samples | \# mutations| \# subjects
----|-------|-------|---
1 | Wong_NC_2016_693_control_SNV.bed | 27,092|  693
2 | A->C | 990 (3.65%) | 
3 | A->G | 3,812 (14.07%) |
4 | A->T | 815 (3.01%) |
5 | C->G | 1,274 (4.70%) |
6 | C->T | 5,314 (19.61%) |
7 | C->A | 1,298 (4.79%) |
Table:WGS  DNM control sample information 

There are 585,017,944 C's  and 844,868,045 A's in hg19. 


### 100 bp window 

For each mutation type in the above table, fit the Poisson regression on the feature DHS 


mutation type| $\hat{\beta}_0$ (intercept) | $\hat{\beta_1}$ (DHS)
---|-----|-------------|------
 A->C | -10.47 | 0.45
 A->G | -9.08 | 0.33
 A->T | -10.62 | 0.30
 C->G | -10.31 | 0.75
 C->T | -8.87 | 0.70
 C->A | -10.24 | 0.60 
 
 
```{r, echo=T}
 inter=c(-10.47, -9.08, -10.62, -10.31, -8.87, -10.24)
 DHS=matrix(nrow=6, ncol=1)
 DHS[,1]=c(0.45, 0.33, 0.30, 0.75, 0.70, 0.60)
 rownames(DHS)=c("A->C", "A->G", "A->T", "C->G", "C->T", "C->A")
 barplot(DHS[,1], col=" blue", xlab="", ylab="DHS (whole genome)")
```
 

#### 


mutation type| $\hat{\beta}_0$ | $\hat{\beta_1}$  | $\hat{\beta_2}$ | $\hat{\beta_3}$ | $\hat{\beta_4}$ | $\hat{\beta_5}$
---|-----|-------------|------|-----|----|-----| 
A->C |-10.47 | 0.45 | | | | 
 A->C | -10.47 | 0.46 | -0.10 | | |
 A->C | -10.51 | 0.47 | -0.08 | 0.11 | |
 A->C (chr1 )| -11.23 | 0.14 | -0.44 | 0.13| 1.53 |
 A->C (chr1) | -11.24 | 0.16 | -0.44 | 0.09 | 1.62 | -0.87 |
 Table: $\beta_0, \beta_1, \beta_2, \beta_3$ are for intercept, DHS,  CpG island and lamin. 

```{r, echo=F}
library(knitr)
para.summary=read.table("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\para.summary2.txt", header=T)[1:22,]
rownames(para.summary)=paste("chr", seq(1,22), sep="")
colnames(para.summary)=c("Intercept","DHS", "CpGisland", "lamin", "gc", "RT")
#para.summary=para.summary*10^5
```

```{r, echo=F}
#kable(para.summary, digits=2, format="html", caption="Mutation A->C ", align="c")
```


```{r, echo=F}
AtoC=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_A_to_C_para.est.optim.50cate.csv", header=T)
AtoG=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_A_to_G_para.est.optim.50cate.csv", header=T)
AtoT=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_A_to_T_para.est.optim.50cate.csv", header=T)
CtoG=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_C_to_G_para.est.optim.50cate.csv", header=T)
CtoT=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_C_to_T_para.est.optim.50cate.csv", header=T)
CtoA=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_C_to_A_para.est.optim.50cate.csv", header=T)
combine=matrix(nrow=6, ncol=5)
combine[1,]=AtoC[,2]
combine[2,]=AtoG[,2]
combine[3,]=AtoT[,2]
combine[4,]=CtoG[,2]
combine[5,]=CtoT[,2]
combine[6,]=CtoA[,2]
rownames(combine)=c("A->C", "A->G", "A->T", "C->G", "C->T", "C->A")
colnames(combine)=c( "DHS", "CpGisland", "lamin", "gc", "RT")
```

```{r, echo=T}
kable(combine, digits=2, format="html", caption="Estimated effect of five features", align="c")
```

* Continuous features are categorized into 50 quantile intervals, and observations in every interval use the same discretized value of the mean 
* use R function Split to cluster windows with similar features including discrete features and categorized features 
* Run R function optim to fit the model 



```{r, echo=F}
barplot(combine[,1], col="blue", main="DHS")
barplot(combine[,2], col="blue", main="CpG island")
barplot(combine[,3], col="blue", main="Lamin")
barplot(combine[,4], col="blue", main="GC content")
barplot(combine[,5], col="blue", main="RT")
```



```{r, echo=F}
para.summary.nointer=read.table("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\para.summary2.withoutintercept.txt", header=T)[1:22,]
rownames(para.summary.nointer)=paste("chr", seq(1,22), sep="")
colnames(para.summary.nointer)=c("DHS", "CpGisland", "lamin", "gc", "RT")
#para.summary=para.summary*10^5
```

```{r, echo=F}
#kable(para.summary.nointer, digits=2, format="html", caption="Mutation A->C without intercept", align="c")
```


```{r, echo=F}
AtoC=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_A_to_C_para.est.50cate.csv", header=T)
AtoG=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_A_to_G_para.est.50cate.csv", header=T)
AtoT=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_A_to_T_para.est.50cate.csv", header=T)
CtoG=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_C_to_G_para.est.50cate.csv", header=T)
CtoT=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_C_to_T_para.est.50cate.csv", header=T)
CtoA=read.csv("D:\\ResearchWork\\StatisticalGenetics\\Mutation-Rate-project\\mutation_C_to_A_para.est.50cate.csv", header=T)
combine=matrix(nrow=6, ncol=6)
combine[1,]=AtoC[,2]
combine[2,]=AtoG[,2]
combine[3,]=AtoT[,2]
combine[4,]=CtoG[,2]
combine[5,]=CtoT[,2]
combine[6,]=CtoA[,2]
rownames(combine)=c("A->C", "A->G", "A->T", "C->G", "C->T", "C->A")
colnames(combine)=c("Intercept", "DHS", "CpGisland", "lamin", "gc", "RT")
```

```{r, echo=T}
kable(combine, digits=2, format="html", caption="Estimated effect of five features", align="c")
```

* Continuous features are categorized into 50 quantile intervals, and observations in every interval use the same discretized value of the mean 
* use R function Split to cluster windows with similar features including discrete features and categorized features 
* For each window cluster, use averaged mutation and features to run GLM. 



```{r, echo=F}
barplot(combine[,1], col="blue", main="Intercept")
barplot(combine[,2], col="blue", main="DHS")
barplot(combine[,3], col="blue", main="CpG island")
barplot(combine[,4], col="blue", main="Lamin")
barplot(combine[,5], col="blue", main="GC content")
barplot(combine[,6], col="blue", main="RT")
```



## Session information


<!-- Insert the session information into the document -->
```{r session-info}
```
